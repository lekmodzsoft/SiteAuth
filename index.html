<!DOCTYPE html>
<html>
<head>
  <title>Gerador de Chave</title>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      padding-top: 60px;
      background-color: #f0f0f5;
    }

    h2 {
      color: #333;
    }

    .button {
      background-color: #2979ff;
      color: white;
      border: none;
      padding: 15px 30px;
      font-size: 18px;
      border-radius: 8px;
      margin: 15px;
      cursor: pointer;
    }

    #status {
      margin-top: 30px;
      font-size: 20px;
      color: #444;
    }
  </style>
</head>
<body>

<h2>Obtenha sua Chave Premium</h2>
<button class="button" onclick="irParaAnuncio()">Ir para Anúncio</button>
<button class="button" onclick="gerarChave()">Gerar Chave</button>

<p id="status">Siga os passos acima</p>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyANPpEYbCsD2oD94jN0SdyivaJ8v4ouDHI",
    authDomain: "authapp-42b96.firebaseapp.com",
    databaseURL: "https://authapp-42b96-default-rtdb.firebaseio.com",
    projectId: "authapp-42b96",
    storageBucket: "authapp-42b96.appspot.com",
    messagingSenderId: "112283156057",
    appId: "1:112283156057:web:aa4426ab0bd86ba22e3b48",
    measurementId: "G-4DT108HGQF"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  let currentToken = "";

  function gerarToken() {
    return "token-" + Math.random().toString(36).substring(2, 10);
  }

  function irParaAnuncio() {
    currentToken = gerarToken();
    db.ref("tokens/" + currentToken).set({ usado: false });
    localStorage.setItem("meuToken", currentToken);
    window.open("https://gplinks.co/SEULINKAQUI", "_blank"); // troque pelo seu link gplinks
    document.getElementById("status").innerText = "Após pular o anúncio, clique em 'Gerar Chave'.";
  }

  function gerarChave() {
    const token = localStorage.getItem("meuToken");
    if (!token) {
      alert("Clique primeiro em 'Ir para Anúncio'.");
      return;
    }

    db.ref("tokens/" + token).get().then(snapshot => {
      if (!snapshot.exists()) {
        alert("Token inválido. Gere um novo.");
      } else if (snapshot.val().usado) {
        alert("Esse token já foi usado. Clique em 'Ir para Anúncio' novamente.");
      } else {
        const chave = "KEY-" + Math.random().toString(36).substring(2, 10).toUpperCase();
        db.ref("tokens/" + token).update({ usado: true });
        document.getElementById("status").innerText = "Sua chave: " + chave;
      }
    });
  }
</script>

</body>
</html>
